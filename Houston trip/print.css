/*
 * Guide de Voyage Houston 2025
 * Styles d'impression optimisés et améliorés
 * Inspiré des bonnes pratiques d'impression responsive et accessible
 * Compatible avec tous les navigateurs modernes et anciens
 */

/* ========================================
   1. PAGE SETUP AND DOCUMENT STRUCTURE
   ======================================== */

/* Configuration globale des pages avec support navigateurs modernes et anciens */
@page {
    /* Définition des marges physiques de la page A4 */
    margin: 1.5cm;
    size: A4 portrait;
    
    /* Amélioration: En-têtes et pieds de page automatiques */
    @top-center {
      content: "Guide de Voyage Houston 2025";
      font-size: 9pt;
      color: #666;
    }
    
    @bottom-center {
      content: "Page " counter(page) " sur " counter(pages);
      font-size: 9pt;
      color: #666;
    }
  }
  
  /* Configuration spécifique pour la première page */
  @page :first {
    @top-center { content: none; } /* Pas d'en-tête sur la première page */
  }
  
  /* Réinitialisation complète pour l'impression */
  html, body {
    /* Réinitialisation des marges pour éviter les chevauchements */
    margin: 0 !important;
    padding: 0 !important;
    width: 100% !important;
    max-width: 100% !important;
    
    /* Typographie optimisée pour l'impression */
    font-family: "DejaVu Serif", Georgia, "Times New Roman", serif !important;
    font-size: 11pt !important;
    line-height: 1.4 !important;
    
    /* Garantir fond blanc et texte noir pour meilleure lisibilité et économie d'encre */
    background: white !important;
    color: black !important;
    
    /* Amélioration: Éviter les débordements */
    overflow-wrap: break-word !important;
    word-wrap: break-word !important;
  }
  
  /* ========================================
     2. ÉLÉMENTS À MASQUER
     ======================================== */
  
  /* 
   * Masquage complet des éléments non pertinents pour l'impression
   * Amélioration: liste plus complète et sélecteurs plus génériques
   */
  header, nav, #main-header, #floating-nav, #nav-menu, 
  #back-to-top, #theme-toggle, #print-btn, 
  .navigation, .nav-buttons, .social-sharing, 
  button:not(.print-only), .video-container, 
  .interactive-map, .cookie-banner, .ad-container {
    display: none !important;
    visibility: hidden !important;
    height: 0 !important;
    width: 0 !important;
    overflow: hidden !important;
    clip: rect(1px, 1px, 1px, 1px) !important;
    position: absolute !important;
  }
  
  /* Hide images when printing */
  img {
    display: none !important;
    visibility: hidden !important;
    height: 0 !important;
    width: 0 !important;
    overflow: hidden !important;
    clip: rect(1px, 1px, 1px, 1px) !important;
    position: absolute !important;
  }
  
  /* ========================================
     3. STRUCTURE DU CONTENU
     ======================================== */
  
  /* Gestion améliorée des sections de contenu */
  main, article, section, .content-section, #toc {
    margin: 0 0 1em !important;
    padding: 1em !important;
    
    /* Compatibilité cross-browser pour éviter les coupures de sections */
    break-inside: avoid !important;
    page-break-inside: avoid !important;
    
    /* Amélioration: Meilleure gestion des bordures et ombres */
    border: none !important;
    box-shadow: none !important;
    background: none !important;
  }
  
  /* Amélioration: Page de couverture */
  .cover-page {
    text-align: center !important;
    height: 90vh !important;
    display: flex !important;
    flex-direction: column !important;
    justify-content: center !important;
    break-after: page !important;
    page-break-after: always !important;
  }
  
  .cover-page h1 {
    font-size: 24pt !important;
    border: none !important;
    margin-bottom: 2cm !important;
  }
  
  /* Table des matières avec numéros de page */
  #toc {
    break-after: page !important;
    page-break-after: always !important;
  }
  
  #toc a::after {
    content: " " leader(".") " " target-counter(attr(href), page) !important;
    float: right !important;
  }
  
  /* ========================================
     4. TYPOGRAPHIE ET HIÉRARCHIE
     ======================================== */
  
  /* Hiérarchie des titres améliorée */
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid !important;
    break-after: avoid !important;
    page-break-inside: avoid !important;
    break-inside: avoid !important;
    orphans: 3 !important;
    widows: 3 !important;
    font-family: "DejaVu Sans", Arial, Helvetica, sans-serif !important;
  }
  
  h1 {
    font-size: 18pt !important;
    margin: 2em 0 1em !important;
    padding-bottom: 0.5em !important;
    border-bottom: 1pt solid #000 !important;
    text-align: center !important;
  }
  
  h2 {
    font-size: 16pt !important;
    margin: 1.5em 0 0.8em !important;
    padding-bottom: 0.3em !important;
    border-bottom: 0.5pt solid #333 !important;
  }
  
  h3 {
    font-size: 14pt !important;
    margin: 1.2em 0 0.6em !important;
  }
  
  h4 {
    font-size: 12pt !important;
    margin: 1em 0 0.5em !important;
    font-style: italic !important;
  }
  
  /* Amélioration: Gestion des paragraphes */
  p {
    margin: 0.5em 0 1em !important;
    orphans: 3 !important; /* Minimum 3 lignes en bas de page */
    widows: 3 !important;  /* Minimum 3 lignes en haut de page */
  }
  
  /* ========================================
     5. ÉLÉMENTS VISUELS ET MÉDIAS
     ======================================== */
  
  /* Gestion optimisée des images */
  img, figure {
    max-width: 100% !important;
    height: auto !important;
    
    /* Amélioration: Contraste et qualité optimisée pour impression */
    -webkit-print-color-adjust: exact !important;
    color-adjust: exact !important;
    print-color-adjust: exact !important;
    
    /* Compatibilité cross-browser pour éviter les coupures */
    break-inside: avoid !important;
    page-break-inside: avoid !important;
    
    /* Amélioration: Alignement et marges */
    display: block !important;
    margin: 1.5em auto !important;
    clear: both !important;
  }
  
  /* Gestion des légendes */
  figcaption {
    font-size: 9pt !important;
    font-style: italic !important;
    text-align: center !important;
    margin-top: 0.5em !important;
    color: #333 !important;
  }
  
  /* Amélioration: Ajustement des images selon leur importance */
  .image-gallery img {
    max-height: 10cm !important; /* Limite pour les galeries */
  }
  
  .hero-image img {
    max-height: 15cm !important; /* Plus grand pour les images principales */
  }
  
  .icon img, .small-image img {
    max-height: 1cm !important; /* Plus petit pour les icônes */
    display: inline-block !important;
    vertical-align: middle !important;
    margin: 0 0.3em !important;
  }
  
  /* ========================================
     6. TABLEAUX ET DONNÉES STRUCTURÉES
     ======================================== */
  
  /* Tableaux optimisés pour l'impression */
  table {
    width: 100% !important;
    border-collapse: collapse !important;
    margin: 1.5em 0 !important;
    font-size: 10pt !important; /* Légèrement plus petit pour les tableaux */
    
    /* Compatibilité cross-browser pour éviter les coupures */
    break-inside: avoid !important;
    page-break-inside: avoid !important;
  }
  
  /* Amélioration: Entêtes de tableau distinctes */
  thead {
    display: table-header-group !important;
    break-inside: avoid !important;
    page-break-inside: avoid !important;
  }
  
  tbody {
    break-inside: auto !important; /* Permettre la coupure entre les lignes si nécessaire */
  }
  
  tr {
    break-inside: avoid !important;
    page-break-inside: avoid !important;
  }
  
  th {
    background-color: #f0f0f0 !important;
    -webkit-print-color-adjust: exact !important;
    color-adjust: exact !important;
    print-color-adjust: exact !important;
    font-weight: bold !important;
    text-align: left !important;
    padding: 0.5em !important;
    border: 1pt solid #000 !important;
  }
  
  td {
    padding: 0.5em !important;
    border: 0.5pt solid #666 !important;
    vertical-align: top !important;
  }
  
  /* Amélioration: Alternance de couleurs pour les lignes */
  tr:nth-child(even) {
    background-color: #f9f9f9 !important;
    -webkit-print-color-adjust: exact !important;
    color-adjust: exact !important;
    print-color-adjust: exact !important;
  }
  
  /* ========================================
     7. NAVIGATION ET HYPERLIENS
     ======================================== */
  
  /* Liens et références améliorés */
  a {
    color: black !important;
    text-decoration: none !important;
    font-weight: normal !important;
  }
  
  /* Amélioration: Affichage conditionnel des URLs */
  a[href^="http"]:after {
    content: " (" attr(href) ")" !important;
    font-size: 90% !important;
    color: #444 !important;
    font-style: italic !important;
    word-wrap: break-word !important;
  }
  
  /* Ne pas afficher l'URL pour certains types de liens */
  a[href^="#"]:after,
  a.no-print-url:after,
  a[href^="mailto:"]:after,
  a[href^="tel:"]:after {
    content: "" !important;
  }
  
  /* Amélioration: Traitement spécial pour les liens de référence */
  .reference a:after {
    content: " [" attr(href) "]" !important;
    font-size: 8pt !important;
    vertical-align: super !important;
  }
  
  /* ========================================
     8. ELEMENTS SPÉCIAUX ET CITATIONS
     ======================================== */
  
  /* Amélioration: Mise en forme des citations */
  blockquote {
    margin: 1.5em 2em !important;
    padding: 1em !important;
    border-left: 3pt solid #999 !important;
    font-style: italic !important;
    page-break-inside: avoid !important;
    break-inside: avoid !important;
  }
  
  /* Amélioration: Notes de bas de page */
  .footnote, .note {
    font-size: 9pt !important;
    margin-top: 2em !important;
    padding-top: 1em !important;
    border-top: 0.5pt solid #999 !important;
  }
  
  /* Amélioration: Mise en avant des avertissements */
  .warning, .alert, .important {
    border: 1pt solid #000 !important;
    padding: 0.5em 1em !important;
    margin: 1em 0 !important;
    page-break-inside: avoid !important;
    break-inside: avoid !important;
  }
  
  /* ========================================
     9. PAGINATION ET SAUTS DE PAGE
     ======================================== */
  
  /* Sauts de page avant les sections principales */
  .major-section, [id^="section"], h1 + .content-section {
    break-before: page !important;
    page-break-before: always !important;
    margin-top: 0 !important; /* Réinitialiser la marge après saut de page */
  }
  
  /* Amélioration: Éviter les sauts de page inopportuns */
  li, dt, dd, p + p {
    break-inside: avoid !important;
    page-break-inside: avoid !important;
  }
  
  /* Amélioration: Forcer les sauts de page à certains endroits */
  .page-break, .new-page {
    break-before: page !important;
    page-break-before: always !important;
    visibility: hidden !important;
    height: 0 !important;
  }
  
  /* ========================================
     10. ÉCONOMIE D'ENCRE ET PERFORMANCE
     ======================================== */
  
  /* Amélioration: Mode économie d'encre */
  .print-economy {
    background: none !important;
    color: black !important;
  }
  
  .print-economy img {
    filter: grayscale(100%) !important;
    -webkit-filter: grayscale(100%) !important;
  }
  
  /* Amélioration: Support transparent pour les arrière-plans */
  * {
    -webkit-print-color-adjust: economy !important;
    color-adjust: economy !important;
    print-color-adjust: economy !important;
  }
  
  .print-quality * {
    -webkit-print-color-adjust: exact !important;
    color-adjust: exact !important;
    print-color-adjust: exact !important;
  }
  
  /* ========================================
     11. ACCESSIBILITÉ ET LISIBILITÉ
     ======================================== */
  
  /* Amélioration: Police lisible et taille minimale */
  p, li, td {
    font-size: 11pt !important;
    line-height: 1.4 !important;
    min-font-size: 9pt !important; /* Empêche le texte trop petit */
  }
  
  /* Amélioration: Contraste élevé */
  * {
    color: black !important;
  }
  
  /* Contenu uniquement pour impression */
  .print-only {
    display: block !important;
    visibility: visible !important;
  }
  
  /* ========================================
     12. PIED DE PAGE ET INFORMATIONS LÉGALES
     ======================================== */
  
  /* Pied de page amélioré */
  footer, .footer {
    margin-top: 2em !important;
    padding-top: 1em !important;
    border-top: 1pt solid #999 !important;
    text-align: center !important;
    font-size: 9pt !important;
    color: #666 !important;
  }
  
  /* Date d'impression automatique */
  footer:after {
    content: "Document imprimé le " attr(data-print-date) !important;
    display: block !important;
    margin-top: 0.5em !important;
    font-size: 8pt !important;
  }
  
  /* Script pour ajouter la date d'impression */
  @media print {
    footer:after {
      content: "Document imprimé le " attr(data-print-date) !important;
    }
  }